C51 COMPILER V9.01   NEWSLAVE                                                              11/01/2012 16:17:42 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE NEWSLAVE
OBJECT MODULE PLACED IN newSlave.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE newSlave.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          
   2          
   3          #include"N79E81x.h"
   4          #include<intrins.h>
   5          #include"AD.h"
   6          #include"UART.h"
   7          #include"T0.h"
   8          #include"voice.h"
   9          #include"pwm.h"
*** ERROR C231 IN LINE 13 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'P0': redefinition
*** ERROR C231 IN LINE 14 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'P1': redefinition
*** ERROR C231 IN LINE 15 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'P2': redefinition
*** ERROR C231 IN LINE 16 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'P3': redefinition
*** ERROR C231 IN LINE 17 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'PSW': redefinition
*** ERROR C231 IN LINE 18 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'ACC': redefinition
*** ERROR C231 IN LINE 19 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'B': redefinition
*** ERROR C231 IN LINE 20 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'SP': redefinition
*** ERROR C231 IN LINE 21 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'DPL': redefinition
*** ERROR C231 IN LINE 22 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'DPH': redefinition
*** ERROR C231 IN LINE 23 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'PCON': redefinition
*** ERROR C231 IN LINE 24 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TCON': redefinition
*** ERROR C231 IN LINE 25 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TMOD': redefinition
*** ERROR C231 IN LINE 26 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TL0': redefinition
*** ERROR C231 IN LINE 27 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TL1': redefinition
*** ERROR C231 IN LINE 28 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TH0': redefinition
*** ERROR C231 IN LINE 29 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TH1': redefinition
*** ERROR C231 IN LINE 30 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'IE': redefinition
*** ERROR C231 IN LINE 31 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'IP': redefinition
*** ERROR C231 IN LINE 32 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'SCON': redefinition
*** ERROR C231 IN LINE 33 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'SBUF': redefinition
*** ERROR C231 IN LINE 38 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'CY': redefinition
*** ERROR C231 IN LINE 39 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'AC': redefinition
*** ERROR C231 IN LINE 40 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'F0': redefinition
*** ERROR C231 IN LINE 41 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'RS1': redefinition
*** ERROR C231 IN LINE 42 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'RS0': redefinition
*** ERROR C231 IN LINE 43 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'OV': redefinition
*** ERROR C231 IN LINE 44 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'P': redefinition
*** ERROR C231 IN LINE 47 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TF1': redefinition
*** ERROR C231 IN LINE 48 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TR1': redefinition
*** ERROR C231 IN LINE 49 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TF0': redefinition
*** ERROR C231 IN LINE 50 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TR0': redefinition
*** ERROR C231 IN LINE 51 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'IE1': redefinition
*** ERROR C231 IN LINE 52 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'IT1': redefinition
*** ERROR C231 IN LINE 53 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'IE0': redefinition
*** ERROR C231 IN LINE 54 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'IT0': redefinition
*** ERROR C231 IN LINE 57 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'EA': redefinition
*** ERROR C231 IN LINE 58 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'ES': redefinition
*** ERROR C231 IN LINE 59 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'ET1': redefinition
*** ERROR C231 IN LINE 60 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'EX1': redefinition
*** ERROR C231 IN LINE 61 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'ET0': redefinition
*** ERROR C231 IN LINE 62 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'EX0': redefinition
*** ERROR C231 IN LINE 65 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'PS': redefinition
*** ERROR C231 IN LINE 66 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'PT1': redefinition
*** ERROR C231 IN LINE 67 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'PX1': redefinition
*** ERROR C231 IN LINE 68 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'PT0': redefinition
C51 COMPILER V9.01   NEWSLAVE                                                              11/01/2012 16:17:42 PAGE 2   

*** ERROR C231 IN LINE 69 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'PX0': redefinition
*** ERROR C231 IN LINE 75 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'T0': redefinition
*** ERROR C231 IN LINE 76 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'INT1': redefinition
*** ERROR C231 IN LINE 77 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'INT0': redefinition
*** ERROR C231 IN LINE 78 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TXD': redefinition
*** ERROR C231 IN LINE 79 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'RXD': redefinition
*** ERROR C231 IN LINE 82 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'SM0': redefinition
*** ERROR C231 IN LINE 83 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'SM1': redefinition
*** ERROR C231 IN LINE 84 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'SM2': redefinition
*** ERROR C231 IN LINE 85 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'REN': redefinition
*** ERROR C231 IN LINE 86 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TB8': redefinition
*** ERROR C231 IN LINE 87 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'RB8': redefinition
*** ERROR C231 IN LINE 88 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'TI': redefinition
*** ERROR C231 IN LINE 89 OF C:\KEIL\C51\INC\ATMEL\REG51.H: 'RI': redefinition
*** ERROR C231 IN LINE 28 OF PWM.H: 'P0M1': redefinition
*** ERROR C231 IN LINE 32 OF PWM.H: 'P2M1': redefinition
*** ERROR C231 IN LINE 34 OF PWM.H: 'P3M1': redefinition
  10          
  11          
  12          
  13          
  14          
  15          
  16          
  17          //主机的发射部分的控制端口
  18          //sbit PWMout=P3^5;//发射机的方波输出口
  19          sbit ModeControl_1=P2^6;//发射机模式控制,0亮为1.5M模式，1灭为3M模式
  20          
  21          
  22          
  23          
  24          //开关按键
  25          sbit Turn=P0^3;//开关
  26          
  27          //模式选择按键
  28          sbit ModeChange=P0^4;
  29          
  30          
  31          
  32          //马达控制端
  33          sbit Moto=P2^4;
  34          
  35          
  36          ////功率放大的器
  37          //sbit PowerControl_1=P1^5;
  38          //sbit PowerControl_2=P1^4;
  39          
  40          
  41          //电池控制      AD的1号通道为电池的电量检测端
  42          //sbit BatteryOut=P1^1;//低电指示
  43          
  44          
  45          
  46          
  47          //作为接收和发送的缓存区
  48          unsigned char TxRxBuf[28]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
             -,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
  49          //一个头字节，一个地址字节，一个命令字节，两个编码地址字节，两个编码
  50          unsigned char myTxRxData[7]={0x00,0x00,0x00,0x00,0x00,0x00,0x00};//处理完后的通信数据的缓冲区
  51          
  52          
  53          
C51 COMPILER V9.01   NEWSLAVE                                                              11/01/2012 16:17:42 PAGE 3   

  54          
  55          void main()
  56          {
  57   1      }
  58          
  59          
  60          
  61          
  62          
  63          
  64          
  65          
  66          
  67          
  68          
  69          
  70          
  71          
  72          void ComMode_1_Data(unsigned int sendAddr)//发送边码1
  73          {
  74   1              ModeControl_1=0;//30M发射功率                           
  75   1              myPwm();        //开发射机
  76   1      //                      ModeTurn=0;
  77   1      
  78   1      
  79   1              myTxRxData[0]=CmdHead;
  80   1              myTxRxData[1]=MyAddress;
  81   1      
  82   1              myTxRxData[2]=ComMode_1;
  83   1      
  84   1              myTxRxData[5]=PassWord[sendAddr];
  85   1              myTxRxData[6]=PassWord[sendAddr+1];
  86   1      
  87   1              myTxRxData[3]=sendAddr;
  88   1              myTxRxData[4]=sendAddr>>8;
  89   1      
  90   1              codeData(myTxRxData,7);
  91   1      
  92   1              SendNByte(TxRxBuf,28);
  93   1      
  94   1              PWMCON0=0x00;//关闭PWM
  95   1              P0M1|=0x02;      //高阻模式     ，相当关发射机
  96   1              P0M2=0;
  97   1      }
  98          
  99          
 100          
 101          
 102          
 103          
 104          
 105          
 106          
 107          
 108          
 109          void codeData(unsigned char *doData,unsigned char len)          //编码 ,电平1变为0011，电平0变为1100
 110          {
 111   1              unsigned char n,j,i=0;
 112   1              for(n=0;n<len;n++)
 113   1              {       
 114   2                      
 115   2                      for(j=0;j<8;j++)        
C51 COMPILER V9.01   NEWSLAVE                                                              11/01/2012 16:17:42 PAGE 4   

 116   2                      {
 117   3                              if(j==0||j==1)
 118   3                              {       
 119   4                                       TxRxBuf[i]<<=4;
 120   4                                      if((*doData&0x80)==0x80)
 121   4                                      {
 122   5                                              TxRxBuf[i]|=0x03;       
 123   5                                      }
 124   4                                      else
 125   4                                      {
 126   5                                              TxRxBuf[i]|=0x0c;
 127   5                                      }
 128   4                                      *doData<<=1;
 129   4                              }
 130   3                              else if(j==2||j==3)
 131   3                              {
 132   4                                      TxRxBuf[i+1]<<=4;
 133   4                                      if((*doData&0x80)==0x80)
 134   4                                      {
 135   5                                              TxRxBuf[i+1]|=0x03;     
 136   5                                      }
 137   4                                      else
 138   4                                      {
 139   5                                              TxRxBuf[i+1]|=0x0c;
 140   5                                      }
 141   4                                      *doData<<=1;
 142   4                              }
 143   3                              else if(j==4||j==5)
 144   3                              {
 145   4                                      TxRxBuf[i+2]<<=4;
 146   4                                      if((*doData&0x80)==0x80)
 147   4                                      {
 148   5                                              TxRxBuf[i+2]|=0x03;             
 149   5                                      }
 150   4                                      else
 151   4                                      {
 152   5                                              TxRxBuf[i+2]|=0x0c;
 153   5                                      }
 154   4                                      *doData<<=1;
 155   4                              }
 156   3                              else if(j==6||j==7)
 157   3                              {
 158   4                                      TxRxBuf[i+3]<<=4;
 159   4                                      if((*doData&0x80)==0x80)
 160   4                                      {
 161   5                                              TxRxBuf[i+3]|=0x03;                                             
 162   5                                      }
 163   4                                      else
 164   4                                      {
 165   5                                              TxRxBuf[i+3]|=0x0c;                             
 166   5                                      }
 167   4                                      *doData<<=1;
 168   4                              }
 169   3      
 170   3                      }
 171   2                      i+=4;
 172   2                      doData++;
 173   2              }
 174   1      }
 175          
 176          void transCode(unsigned char *doData,unsigned char len)//解码，将接收到得数据还原
 177          {
C51 COMPILER V9.01   NEWSLAVE                                                              11/01/2012 16:17:42 PAGE 5   

 178   1              unsigned char i,j;
 179   1              for(i=0;i<len;i++)
 180   1              {
 181   2                      for(j=0;j<2;j++)
 182   2                      {
 183   3                              myTxRxData[i/4]<<=1;
 184   3      
 185   3                              if((*doData&0x30)==0x30)//说明为1
 186   3                              {
 187   4                                      myTxRxData[i/4]|=0x01;
 188   4                                      
 189   4                              }
 190   3                              else if((*doData&0xc0)==0xc0)  //说明为0
 191   3                              {
 192   4                                      myTxRxData[i/4]&=0xfe;  
 193   4                              }
 194   3      
 195   3      
 196   3                              *doData<<=4;
 197   3                      }
 198   2                      doData++;
 199   2                              
 200   2              }
 201   1      
 202   1      }

C51 COMPILATION COMPLETE.  0 WARNING(S),  63 ERROR(S)
